<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Checklist Conformidade UG</title>

<style>

body{
font-family: Arial;
margin:20px;
background:#ffffff;
}

h1{
color:#003366;
text-align:center;
}

h2{
background:#cfe2ff;
padding:8px;
border:1px solid #666;
}

table{
width:100%;
border-collapse:collapse;
margin-bottom:30px;
}

th,td{
border:1px solid #888;
padding:6px;
font-size:14px;
}

th{
background:#e6f0ff;
}

select,textarea{
width:100%;
}

textarea{
height:60px;
}

button{
padding:12px 30px;
font-size:16px;
background:#003366;
color:white;
border:none;
cursor:pointer;
}

button:hover{
background:#0055aa;
}

.topo{
display:flex;
align-items:center;
gap:20px;
}

.topo img{
height:80px;
}

.cabecalho{
margin-top:20px;
margin-bottom:20px;
}

</style>
</head>

<body>

<div class="topo">
<img src="logo.png">
<h1>CHECKLIST DE CONFORMIDADE CONTÁBIL DE UG</h1>
</div>

<div class="cabecalho">

<label>Unidade Gestora:</label>
<select id="ug">
<option value="">Selecione</option>
<option>100001 - SMG</option>
<option>100002 - SMF</option>
</select>

<br><br>

<label>Período de Apuração:</label>
<input type="month" id="periodo">

<br><br>

<label>Gerente:</label>
<select id="gerente">
<option>Selecione</option>
<option>Gerente A</option>
<option>Gerente B</option>
</select>

<br><br>

<label>Contador:</label>
<select id="contador">
<option>Selecione</option>
<option>Contador X</option>
<option>Contador Y</option>
</select>

</div>

<!-- A PARTIR DAQUI ENTRARÃO OS BLOCOS -->

<!--<div id="blocos"></div>-->
  <h2>1 - CONCILIAÇÃO BANCÁRIA</h2>

<table>
<thead>
<tr>
<th>Item</th>
<th>Descrição</th>
<th>Conformidade</th>
<th>Observação</th>
</tr>
</thead>

<tbody>

<tr>
<td>1.1</td>
<td>Todos os valores identificados como receitas foram conciliados com os extratos bancários?</td>
<td>
<select>
<option>Sim</option>
<option>Não</option>
<option>N/A</option>
</select>
</td>
<td><textarea></textarea></td>
</tr>

<tr>
<td>1.2</td>
<td>Todas as saídas de recursos para pagamento foram conciliadas com os extratos bancários?</td>
<td>
<select>
<option>Sim</option>
<option>Não</option>
<option>N/A</option>
</select>
</td>
<td><textarea></textarea></td>
</tr>

<tr>
<td>1.3</td>
<td>As pendências conciliatórias estão devidamente identificadas e justificadas?</td>
<td>
<select>
<option>Sim</option>
<option>Não</option>
<option>N/A</option>
</select>
</td>
<td><textarea></textarea></td>
</tr>

<tr>
<td>1.4</td>
<td>Os saldos contábeis estão compatíveis com os saldos bancários?</td>
<td>
<select>
<option>Sim</option>
<option>Não</option>
<option>N/A</option>
</select>
</td>
<td><textarea></textarea></td>
</tr>

<tr>
<td>1.5</td>
<td>As conciliações bancárias estão sendo realizadas mensalmente?</td>
<td>
<select>
<option>Sim</option>
<option>Não</option>
<option>N/A</option>
</select>
</td>
<td><textarea></textarea></td>
</tr>

</tbody>
</table>

<button onclick="finalizar()">FINALIZAR PREENCHIMENTO</button>

<script>

function finalizar(){

if(!confirm("Tem certeza que deseja finalizar o preenchimento?")){
return;
}

let ug = document.getElementById("ug").value;
let periodo = document.getElementById("periodo").value;

let linhas = document.querySelectorAll("tbody tr");

let csv = "UG;Periodo;Item;Descricao;Conformidade;Observacao\n";

linhas.forEach(linha=>{

let item = linha.cells[0].innerText;
let desc = linha.cells[1].innerText;
let conf = linha.cells[2].querySelector("select").value;
let obs = linha.cells[3].querySelector("textarea").value;

csv += `${ug};${periodo};${item};${desc};${conf};${obs}\n`;

});

let blob = new Blob([csv], {type:"text/csv;charset=utf-8;"});
let link = document.createElement("a");
link.href = URL.createObjectURL(blob);
link.download = `Conformidade_${ug}_${periodo}.csv`;
link.click();

window.print();

}

</script>

</body>
</html>
